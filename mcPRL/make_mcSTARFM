CUDA_INSTALL_PATH = /usr/local/cuda-9.0
MPI_INSTALL_PATH = /opt/openmpi
NVCC = $(CUDA_INSTALL_PATH)/bin/nvcc  
MPICC = $(MPI_INSTALL_PATH)/bin/mpic++  
LIBS =  -L$(CUDA_INSTALL_PATH)/lib64 -lcudart -lcurand -lgdal
CUDAINCLUDE = -I $(CUDA_INSTALL_PATH)/include
MPICCINCLUDE = -I $(MPI_INSTALL_PATH)/include
CFILES = pgtiol-dataset.cpp  pgtiol-gTiffData.cpp  pgtiol-gTiffManager.cpp  pgtiol-gTiffMetaData.cpp prpl-basicTypes.cpp prpl-cellspaceGeoinfo.cpp prpl-cellspaceInfo.cpp prpl-cellspace.cpp prpl-cellStream.cpp  prpl-exchangeMap.cpp prpl-layer.cpp prpl-neighborhood.cpp prpl-ownershipMap.cpp prpl-process.cpp prpl-smplDcmp.cpp prpl-subCellspace.cpp prpl-subCellspaceInfo.cpp  
CUFILES = cuSTARFM_main.cu prpl-transition.cu prpl-transferInfo.cu prpl-dataManager.cu cuSTARFM.cu DevicePara.cu
OBJECTS =  cuLink.o pgtiol-dataset.o  pgtiol-gTiffData.o  pgtiol-gTiffManager.o  pgtiol-gTiffMetaData.o prpl-basicTypes.o prpl-cellspaceGeoinfo.o prpl-cellspaceInfo.o prpl-cellspace.o prpl-cellStream.o  prpl-exchangeMap.o prpl-layer.o prpl-neighborhood.o prpl-ownershipMap.o prpl-process.o prpl-smplDcmp.o prpl-subCellspace.o prpl-subCellspaceInfo.o cuSTARFM_main.o prpl-transition.o prpl-transferInfo.o prpl-dataManager.o cuSTARFM.o DevicePara.o  
EXECNAME = mcSTARFM  
  
all:  
	$(MPICC) -std=c++11 -c  $(CFILES) $(CUDAINCLUDE)  
	$(NVCC)  -std=c++11  -rdc=true -c $(CUFILES) $(MPICCINCLUDE)
	$(NVCC)   -dlink -o cuLink.o cuSTARFM_main.o prpl-transition.o prpl-transferInfo.o prpl-dataManager.o cuSTARFM.o DevicePara.o 
	$(MPICC)  -o $(EXECNAME) $(LIBS) $(OBJECTS)  
  
clean:  
	rm -f *.o$(EXECNAME)
